---
title: "Homework 1 | STAT 330"
subtitle: <center> <h1>Simple Linear Regression</h1> </center>
author: <center> < Jake Hiltscher > <center>
output: html_document
---

```{=html}
<style type="text/css">
h1.title {
  font-size: 40px;
  text-align: center;
}
</style>
```
```{r setup, include=FALSE}
# load any necessary packages here
```

## Data and Description

Energy can be produced from wind using windmills. Choosing a site for a wind farm (i.e. the location of the windmills), however, can be a multi-million dollar gamble. If wind is inadequate at the site, then the energy produced over the lifetime of the wind farm can be much less than the cost of building the operation. Hence, accurate prediction of wind speed at a candidate site can be an important component in the decision to build or not to build. Since energy produced varies as the square of the wind speed, even small errors in prediction can have serious consequences.

One possible solution to help predict wind speed at a candidate site is to use wind speed at a nearby reference site. A reference site is a nearby location where the wind speed is already being monitored and should, theoretically, be similar to the candidate site. Using information from the reference site will allow windmill companies to know the wind speed at the candidate site without going through a costly data collection period, if the reference site is a good predictor.

The Windmill data set contains measurements of wind speed (in meters per second m/s) at a **candidate site (CSpd) (column 1)** and at an accompanying **reference site (RSpd) (column 2)** for 1,116 areas. Download the Windmill.txt file from Canvas, and put it in the same folder as this R Markdown file.

#### 0. Replace the text "\< PUT YOUR NAME HERE \>" (above next to "author:") with your full name.

#### 1. Briefly explain why simple linear regression is an appropriate tool to use in this situation.

There are two continuous variables. Simple linear regression would allow us to see the relationship and find patterns within the data.

#### 2. Read in the data set, and call the tibble "wind". Print a summary of the data and make sure the data makes sense.

```{r}
wind <- read.table("Windmill.txt", header= TRUE)
wind
```

#### 3. What is the outcome variable in this situation? (Think about which variable makes the most sense to be the response.)

RSpd is the outcome/response variable

#### 4. What is the explanatory variable in this situation?

CSpd is the explanatory/independent variable

#### 5. Create a scatterplot of the data with variables on the appropriate axes. Make the plot square. Add descriptive axis labels with appropriate units. Save the plot to a variable and print the plot.

```{r, fig.align='center'}
library(ggplot2)
wind_base_plot <- ggplot(data = wind) + 
   geom_point(mapping = aes(x = CSpd, y = RSpd)) +
   theme(aspect.ratio = 1)
wind_base_plot
```

#### 6. Briefly describe the relationship between RSpd and CSpd. (Hint: you should use 3 key words in a complete setence that includes referencing the variables.)

As CSpd increases, RSpd tends to increase

#### 7. Calculate the correlation coefficient for the two variables (you may use a built-in R function). Print the result.

```{r}
cor(x=wind$CSpd, y=wind$RSpd,)
```

#### 8. Briefly interpret the number you calculated for the correlation coefficient (what is the direction and strength of the correlation?).

The correlation coefficient is positive and is strong as it is close to 1.

#### 9. Mathematically write out the theoretical/general simple linear regression model for this data set (using parameters ($\beta$s), not estimates, and not using matrix notation). Clearly explain which part of the model is deterministic and which part is random. Do not use "x" and "y" in your model - use variable names that are fairly descriptive.

$\text{RSpd}_i$ $=$ $\beta_0$ $+$ $\beta_1$$\text{CSpd}_i$ $+$ $\epsilon_i$

#### 10. Add the OLS regression line to the scatterplot you created in 4. Print the result. You can remove the standard error line with the option `se = FALSE`.

```{r, fig.align='center'}
wind_linear_model <- wind_base_plot + 
   geom_smooth(mapping = aes(x = CSpd, y = RSpd),
               method = "lm",
               se = FALSE)
wind_linear_model
```

#### 11. (a) Apply linear regression to the data. (b) Print out a summary of the results from the `lm` function. (c) Save the residuals and fitted values to the `wind` tibble. (d) Print the first few rows of the `wind` tibble.

```{r}
wind_lm <- lm( CSpd ~ RSpd , data=wind)
wind_lm
wind$residuals <- wind_lm$residuals
wind$fitted.values <- wind_lm$fitted.values

```

#### 12. Briefly explain the rational behind the ordinary least-squares model fit (how does OLS choose the parameter estimates?).

OLS is used to minimize the amount of error and show the line of best fit.

#### 13. Mathematically write out the fitted simple linear regression model for this data set using the coefficients you found above (do not use parameters/$\beta$s and do not use matrix notation). Do not use "x" and "y" in your model - use variable names that are fairly descriptive.

$\text{RSpd}_i$ $=$ $3.1412$ $+$ $0.7557$ $\text{CSpd}_i$

#### 14. Interpret the coefficient for the slope.

As CSpd increases by a value of 1, RSpd increases by 0.7557.

#### 15. Interpret the coefficient for the intercept.

When CSpd is equal to 0, RSpd equals 3.1412.

#### 16. What is the average wind speed at the candidate site (CSpd) when the wind speed at the reference site (RSpd) is 12 m/s? Show your code, and print the result.

```{r}
predict(wind_lm, newdata = data.frame(RSpd = 12))
```

#### 17. Briefly explain why it would be wrong to answer this question: What is the average wind speed at the candidate site (CSpd) when the wind speed at the reference site (RSpd) is 25 m/s?

There are no values at 25. We cannot estimate values that are outside of the range.

#### 18. Calculate the estimate of $\sigma^2$, the average squared variability of the residuals around the line. Show your code, and print the result.

```{r}
mean(wind_lm$residuals^2)

```

#### 19. Create the design matrix and store it in a variable. Print the first few rows of the design matrix.

```{r}
(wind_mm <- model.matrix(~ RSpd, data = wind))
```

#### 20. Obtain, and print, the parameter estimates for this data set (found above using `lm`) using matrix multiplication. You should use the following in your computations: t() [tranpose], solve() [inverse], %\*% [matrix multiplicaiton].

```{r}
y <- wind$CSpd
betas <- solve(t(wind_mm) %*% wind_mm) %*% t(wind_mm) %*% y
betas <- round(betas, 2)

```

#### 21. Briefly summarize what you learned, personally, from this analysis about the statistics, model fitting process, etc.

It's important not only to look at the graph, but to look at the data behind it. Doing the lm calculations can tell us a lot about the data.

#### 22. Briefly summarize what you learned from this analysis *to a non-statistician*. Write a few sentences about (1) the purpose of this data set and analysis and (2) what you learned about this data set from your analysis. Write your response as if you were addressing a business manager (avoid using statistics jargon) and just provide the main take-aways.

1) The purpose the dataset was to find the relationship between CSpd and Rspd and if there was a pattern. As I analyzed this data, I found that as CSpd increased, RSpd increased as well.
